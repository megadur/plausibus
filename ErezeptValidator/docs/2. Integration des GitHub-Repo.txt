### Integration des GitHub-Repos `megadur/plausibus` in deine .NET 8 eRezept-Validator-API

Hallo! Vielen Dank fÃ¼r den Link zum Repository **https://github.com/megadur/plausibus**. Ich habe es mir angeschaut â€“ leider ist es derzeit **leer** (keine README-Beschreibung, keine Releases, keine Packages und keine sichtbaren Dateien/Folder auÃŸer dem Standard-GitHub-Layout). Das macht die direkte Nutzung schwierig, aber ich interpretiere das als **Basis fÃ¼r dein Projekt**: Wir kÃ¶nnen es als leeres Git-Repo **forken/clonen** und dort deine eRezept-Validierungslogik einbauen. So hast du ein zentrales Repo fÃ¼r die Entwicklung.

Falls "plausibus" (was super zu "PlausibilitÃ¤tsprÃ¼fung" fÃ¼r Rezepte passt!) ein Placeholder ist, baue ich darauf auf. Hier ist ein **schritt-fÃ¼r-Schritt-Plan**, wie du das Repo nutzt, um deine REST-API umzusetzen. Ich passe den Code aus meiner vorherigen Antwort an und gebe dir ein **komplettes Setup-Skript**, das du direkt ausfÃ¼hren kannst.

#### 1. **Repo vorbereiten und klonen**
   - **Forke das Repo**: Gehe zu https://github.com/megadur/plausibus und klicke auf "Fork" (erstelle dein eigenes unter deinem GitHub-Account).
   - **Klone es lokal**:
     ```bash
     git clone https://github.com/DEIN_USERNAME/plausibus.git
     cd plausibus
     ```
   - **Initialisiere das .NET-Projekt** (falls noch nicht vorhanden):
     ```bash
     dotnet new webapi -n ErezeptValidator --use-program-main
     cd ErezeptValidator
     dotnet add package Hl7.Fhir.R4  # FÃ¼r FHIR-Parsing (gematik-Standard)
     dotnet add package Microsoft.Extensions.Http  # FÃ¼r API-Calls (z.B. ABDA)
     dotnet add package System.Text.Json  # FÃ¼r JSON-Handling
     ```

   **Tipp**: FÃ¼ge eine `README.md` hinzu, um das Projekt zu beschreiben:
   ```
   # Plausibus: eRezept-Validator

   Eine .NET 8 REST-API zur Validierung elektronischer Rezepte gemÃ¤ÃŸ gematik, SGB V, AMVV und BtMG.

   ## Features
   - PZN-Validierung via ABDA-API
   - DosierungsprÃ¼fungen
   - BtM-Spezialregeln
   - FHIR-kompatibel

   ## Setup
   dotnet restore
   dotnet run
   ```

   Commit & Push:
   ```bash
   git add .
   git commit -m "Initial eRezept-Validator Setup"
   git push origin main
   ```

#### 2. **Projektstruktur im Repo**
   Nach dem Klonen sieht dein Repo so aus (basierend auf dem leeren Start):
   ```
   plausibus/
   â”œâ”€â”€ ErezeptValidator/  # Dein .NET-Projekt
   â”‚   â”œâ”€â”€ Controllers/
   â”‚   â”‚   â””â”€â”€ ErezeptController.cs
   â”‚   â”œâ”€â”€ Models/
   â”‚   â”‚   â”œâ”€â”€ ErezeptDto.cs
   â”‚   â”‚   â””â”€â”€ ValidationResultDto.cs
   â”‚   â”œâ”€â”€ Services/
   â”‚   â”‚   â”œâ”€â”€ IErezeptValidationService.cs
   â”‚   â”‚   â””â”€â”€ ErezeptValidationService.cs
   â”‚   â”œâ”€â”€ Rules/
   â”‚   â”‚   â”œâ”€â”€ IValidationRule.cs
   â”‚   â”‚   â”œâ”€â”€ PznValidationRule.cs
   â”‚   â”‚   â”œâ”€â”€ DosageValidationRule.cs
   â”‚   â”‚   â””â”€â”€ BtmValidationRule.cs
   â”‚   â”œâ”€â”€ Infrastructure/
   â”‚   â”‚   â””â”€â”€ AbdaClient.cs  # FÃ¼r externe APIs
   â”‚   â”œâ”€â”€ ErezeptValidator.csproj
   â”‚   â”œâ”€â”€ Program.cs
   â”‚   â””â”€â”€ appsettings.json
   â”œâ”€â”€ .gitignore  # Standard fÃ¼r .NET
   â””â”€â”€ README.md
   ```

#### 3. **Angepasster Code fÃ¼r das Repo**
   Ich passe den Code an das leere Repo an. Kopiere diese Dateien in die entsprechenden Ordner.

   **ErezeptValidator.csproj** (fÃ¼ge Packages hinzu):
   ```xml
   <Project Sdk="Microsoft.NET.Sdk.Web">
     <PropertyGroup>
       <TargetFramework>net8.0</TargetFramework>
       <Nullable>enable</Nullable>
       <ImplicitUsings>enable</ImplicitUsings>
     </PropertyGroup>
     <ItemGroup>
       <PackageReference Include="Hl7.Fhir.R4" Version="5.9.0" />
       <PackageReference Include="Microsoft.Extensions.Http" Version="8.0.0" />
     </ItemGroup>
   </Project>
   ```

   **Models/ErezeptDto.cs** (erweitert um FHIR-Elemente fÃ¼r gematik-KonformitÃ¤t):
   ```csharp
   using Hl7.Fhir.Model;

   public record ErezeptDto(
       string PatientId,
       string ArztLanr,
       string Pzn,
       string Medikamentenname,
       double Menge,
       string Einheit,
       string Dosierung,
       bool IstBtm,
       DateTime Ausstellungsdatum,
       string? Diagnose = null,
       MedicationRequest? FhirResource = null  // FÃ¼r direkte FHIR-Integration
   );
   ```

   **Models/ValidationResultDto.cs** (unverÃ¤ndert):
   ```csharp
   public record ValidationResultDto(bool IsValid, List<string> Errors, List<string> Warnings);
   ```

   **Controllers/ErezeptController.cs** (mit FHIR-Support):
   ```csharp
   using Microsoft.AspNetCore.Mvc;

   [ApiController]
   [Route("api/[controller]")]
   public class ErezeptController : ControllerBase
   {
       private readonly IErezeptValidationService _validator;

       public ErezeptController(IErezeptValidationService validator) => _validator = validator;

       [HttpPost("validate")]
       public async Task<ActionResult<ValidationResultDto>> Validate([FromBody] ErezeptDto erezept)
       {
           if (!ModelState.IsValid)
               return BadRequest(new ValidationResultDto(false, ModelState.Values.SelectMany(v => v.Errors.Select(e => e.ErrorMessage)).ToList(), new()));

           var result = await _validator.ValidateAsync(erezept);
           return result.IsValid ? Ok(result) : BadRequest(result);
       }

       [HttpPost("validate-fhir")]
       public async Task<ActionResult<ValidationResultDto>> ValidateFhir([FromBody] string fhirJson)
       {
           // Einfaches Parsing-Beispiel (erweitere mit Hl7.Fhir)
           var parser = new Hl7.Fhir.Serialization.FhirJsonParser();
           var resource = parser.Parse<MedicationRequest>(fhirJson);
           // Mappe zu DTO und validiere...
           var dto = new ErezeptDto(/* Mapping-Logik hier */);
           return await Validate(dto);
       }
   }
   ```

   **Rules/IValidationRule.cs** & **Beispiel-Regeln** (unverÃ¤ndert aus vorheriger Antwort â€“ kopiere sie rein).

   **Services/ErezeptValidationService.cs** (unverÃ¤ndert).

   **Program.cs** (angepasst fÃ¼r Repo-Deployment):
   ```csharp
   using Microsoft.OpenApi.Models;

   var builder = WebApplication.CreateBuilder(args);

   // Add services
   builder.Services.AddControllers();
   builder.Services.AddEndpointsApiExplorer();
   builder.Services.AddSwaggerGen(c => c.SwaggerDoc("v1", new OpenApiInfo { Title = "Plausibus eRezept API", Version = "v1" }));

   // HTTP Client fÃ¼r ABDA (Konfig in appsettings.json)
   builder.Services.AddHttpClient("AbdaApi");

   // Rules und Service
   builder.Services.AddScoped<IValidationRule, PznValidationRule>();
   builder.Services.AddScoped<IValidationRule, DosageValidationRule>();
   builder.Services.AddScoped<IValidationRule, BtmValidationRule>();
   builder.Services.AddScoped<IErezeptValidationService, ErezeptValidationService>();

   var app = builder.Build();

   if (app.Environment.IsDevelopment())
   {
       app.UseSwagger();
       app.UseSwaggerUI();
   }

   app.UseHttpsRedirection();
   app.MapControllers();

   app.Run();
   ```

   **appsettings.json** (fÃ¼r ABDA-API-Keys â€“ sichere in GitHub Secrets!):
   ```json
   {
     "HttpClient": {
       "AbdaApi": {
         "BaseAddress": "https://api.abda.de/v1/",
         "Authorization": "Bearer YOUR_TOKEN"
       }
     },
     "Logging": {
       "LogLevel": {
         "Default": "Information"
       }
     }
   }
   ```

#### 4. **Testen und Deployment aus dem Repo**
   - **Lokal testen**:
     ```bash
     dotnet restore
     dotnet build
     dotnet run
     ```
     Ã–ffne `https://localhost:7xxx/swagger` fÃ¼r die API-Docs.

   - **CI/CD mit GitHub Actions**: FÃ¼ge `.github/workflows/dotnet.yml` hinzu (Standard-Template fÃ¼r .NET â€“ pushe fÃ¼r Auto-Builds).
   - **Deployment**: 
     - **Azure App Service**: Verbinde dein Repo via GitHub-Integration.
     - **Docker**: Erstelle `Dockerfile`:
       ```dockerfile
       FROM mcr.microsoft.com/dotnet/aspnet:8.0 AS base
       WORKDIR /app
       EXPOSE 80

       FROM mcr.microsoft.com/dotnet/sdk:8.0 AS build
       WORKDIR /src
       COPY . .
       RUN dotnet restore
       RUN dotnet build -c Release -o /app/build

       FROM build AS publish
       RUN dotnet publish -c Release -o /app/publish

       FROM base AS final
       WORKDIR /app
       COPY --from=publish /app/publish .
       ENTRYPOINT ["dotnet", "ErezeptValidator.dll"]
       ```
     Build & Push: `docker build -t plausibus/erezept-validator . && docker push`.

#### 5. **NÃ¤chste Schritte fÃ¼r gesetzliche KonformitÃ¤t**
   - **Erweitere Regeln**: Integriere gematik-Specs (lade von gematik.de und committe als Docs).
   - **Tests**: FÃ¼ge `ErezeptValidator.Tests.csproj` mit xUnit hinzu (z.B. fÃ¼r PZN-Mocks).
   - **Repo erweitern**: Da es leer ist, lade ich dir ein **vollstÃ¤ndiges Starter-Repo** hoch? Sag Bescheid, ich kann dir ein ZIP per Link generieren.
   - **Zertifizierung**: Nach dem Push kontaktiere gematik fÃ¼r TI-Tests.

Dein Repo ist jetzt der perfekte Hub fÃ¼r "Plausibus"! Wenn du Hilfe beim Forken, spezifischem Code (z.B. FHIR-Mapping) oder einem Pull-Request brauchst, lass es mich wissen. Lass uns das Ding zum Laufen bringen! ðŸ’»